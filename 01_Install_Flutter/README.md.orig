# Guia do iniciante em Flutter

Este guia visa descrever todo o processo de cria√ß√£o do ambiente de desenvolvimento, desde o download dos fontes, passando pelo processo de build e depois execu√ß√£o do sistema no seu ambiente local.

# Pr√©-requisitos

- Conhecimentos:
  - Linux (desej√°vel)
  - Docker
  - Git
  - Dart
  - Aplica√ß√µes Mobile
  - Bootstrap
  - Html5, css e javascript
- Softwares
  - Linux (desej√°vel)
  - Oh My Zsh - Shell linux integrado com o git, outras linguagens e ferramentas - https://ohmyz.sh/ (desej√°vel)
  - Docker e Docker Compose (Fedora : https://docs.docker.com/install/linux/docker-ce/fedora/ e https://docs.docker.com/compose/install/#prerequisites)
  - Git (deve estar na central de pacotes de sua distribu√ß√£o Linux - git e git-core)
  - Visual Studio Code
  - SDK Flutter


# Passo a passo da configura√ß√£o do ambiente local

Para facilitar o desenvolvimento, vou sugerir criar alguns diret√≥rios para melhor organiza√ß√£o do ambiente local de desenvolvimento. Vou usar essa conven√ß√£o nos comandos abaixo, se n√£o quiser seguir essa conven√ß√£o fa√ßa adapta√ß√µes nos comandos a serem executado.

    $ mkdir -p ~/desenv/ide/android-studio; # Local de descompacta√ß√£o do Android Studio
    $ mkdir -p ~/desenv/ide/vscode; # Local de descompacta√ß√£o do Visual Code
    $ mkdir -p ~/desenv/sdk/flutter; # Local de descompacta√ß√£o do Flutter v1.0.0
    $ mkdir -p ~/desenv/sdk/android; # Local de descompacta√ß√£o do Android SDK
    $ mkdir -p ~/desenv/sdk/jdk; # Local de descompacta√ß√£o do JDK 1.8
    $ mkdir -p ~/desenv/projects/biblioteca-virtual/android; # Workspace do Android Studio (valida√ß√£o da instala√ß√£o do Android Studio)
    $ mkdir -p ~/desenv/projects/biblioteca-virtual/flutter; # Local do nosso projeto

## Instala√ß√£o do SDK do Java

Voc√™ vai precisar para o funcionamento do Android Studio e outras ferramentas!

### Ambiente Linux

Descompactar a vers√£o 1.8.0_181 do java no diret√≥rio indicado abaixo: 

http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html

    cd ~/desenv/sdk/jdk/
    unzip jdk1.8.0_181.zip
    
Obs: Certifique-se que o diret√≥rio do java ficou assim ~/desenv/sdk/jdk/jdk1.8.0_181

E no final do arquivo ~/.bash_profile ou ~/.profile (vai depender de sua distro linux), colocar os trechos abaixo: (ap√≥s edi√ß√£o do arquivo refazer login no linux)

    JAVA_HOME=~/desenv/sdk/jdk/jdk1.8.0_181
    export JAVA_HOME
    
    PATH=$JAVA_HOME/bin:$JAVA_HOME/jre/bin:$PATH

## Instala√ß√£o do SDK Flutter

Para essa aplica√ß√£o de apredizagem iremos trabalhar com a vers√£o est√°vel recem lan√ßada 1.0.0 do Flutter.

### Ambiente Linux

<<<<<<< HEAD
No endere√ßo [https://flutter.io/setup-linux/](https://flutter.io/setup-linux/) voc√™ vai encontrar o "Get Started" para fazer toda sua configura√ß√£o, mais vamos fazer um resumo aqui.. :P.
=======
No endere√ßo [https://flutter.io/setup-linux/](https://flutter.io/setup-linux/) voc√™ vai encontrar o "Get Started" para fazer todas sua configura√ß√£o, mais vamos fazer um resumo aqui.. :P.
>>>>>>> e9b9b8a5fa97c533775b86575206cd495e770f48

Acesse o endere√ßo https://flutter.io/sdk-archive/#linux, baixe o arquivo no diret√≥rio informado abaixo e depois descompacte-o.

    $ mv ~/Downloads/flutter_linux_v1.0.0-stable.tar.xz ~/desenv/sdk/flutter/
    $ cd ~/desenv/sdk/flutter/
    $ tar -xvf flutter_linux_v1.0.0-stable.tar.xz
    $ mv flutter v1.0.0
    
Obs: Certifique-se que o diret√≥rio do flutter ficou assim ~/desenv/sdk/flutter/v1.0.0

E no final do arquivo ~/.bash_profile ou ~/.profile (vai depender de sua distro linux), coloque o trecho abaixo: (ap√≥s edi√ß√£o do arquivo refazer login no linux)

    FLUTTER_HOME=/home/hendi/desenv/sdk/flutter/v1.0.0
    export FLUTTER_HOME

    PATH=$FLUTTER_HOME/bin:$PATH

### Depend√™ncias para o funcionamento do Flutter

Provavelmente voc√™ deve ter entrado no site do flutter e visto que ele √© uma SDK (Software Development Kit), ou seja um conjunto de blibliotecas e ferramentas pra voc√™ criar aplica√ß√µes nativas para Andriod e IOS. 

E basicamente voc√™ s√≥ precisa criar seu app utilizando apenas uma √∫nica linguagem de programa√ß√£o (Dart), que no final ele faz uma ponte para os componentes nativos e em alguns casos converte em c√≥digo nativo da plataforma em que voc√™ fizer o build.

E para que isso funcione, ele precisar√° de algumas depend√™nicas (sdk, ferramentas e bibliotecas). Inclusive ele oferece um utilit√°rio para voc√™ verificar o que est√° faltando no seu sistema operacional pra voc√™ come√ßar a codificar. 

Rode o comando abaixo n seu terminal...

    $ flutter doctor -v

No meu caso a sa√≠da do comando foi essa aqui:

```
  ‚ûú  v1.0.0 git:(dev) flutter doctor -v
    [!] Flutter (Channel stable, v1.0.0, on Linux, locale en_US.UTF-8)
      ‚Ä¢ Flutter version 1.0.0 at /home/hendi/desenv/sdk/flutter/v1.0.0
      ‚Ä¢ Framework revision 5391447fae (13 days ago), 2018-11-29 19:41:26 -0800
      ‚Ä¢ Engine revision 7375a0f414
      ‚Ä¢ Dart version 2.1.0 (build 2.1.0-dev.9.4 f9ebf21297)
      ‚úó Downloaded executables cannot execute on host.
        See https://github.com/flutter/flutter/issues/6207 for more information
        On Debian/Ubuntu/Mint: sudo apt-get install lib32stdc++6
        On Fedora: dnf install libstdc++.i686
        On Arch: pacman -S lib32-libstdc++5

    [‚úó] Android toolchain - develop for Android devices
      ‚úó Unable to locate Android SDK.
        Install Android Studio from: https://developer.android.com/studio/index.html
        On first launch it will assist you in installing the Android SDK components.
        (or visit https://flutter.io/setup/#android-setup for detailed instructions).
        If Android SDK has been installed to a custom location, set $ANDROID_HOME to that location.

    [‚úó] Android Studio (not installed)
      ‚Ä¢ Android Studio not found; download from https://developer.android.com/studio/index.html
        (or visit https://flutter.io/setup/#android-setup for detailed instructions).

    [!] VS Code (version 1.29.1)
      ‚Ä¢ VS Code at /usr/share/code
      ‚Ä¢ Flutter extension not installed; install from
        https://marketplace.visualstudio.com/items?itemName=Dart-Code.flutter

    [!] Connected devices
      ! No devices available

  ! Doctor found issues in 5 categories.

```

Ou seja, foram encontrado problemas em 5 categorias.

#### 1 - Andriod Studio

Bom, vou come√ßar pelo Android Studio! 

Como solicitado pelo comando 'flutter doctor', vamos no [link](https://developer.android.com/studio/index.html) fazer o download do Android Studio para come√ßar nossa instala√ß√£o.

Baixe a vers√£o _**3.2 for Linux 64-bit (1006 MB)**_ e comece a instala√ß√£o conforme comandos abaixo.

    cd ~/desenv/ide/android-studio
    unzip ~/Downloads/android-studio-ide-181.5014246-linux.zip
    mv android-studio android-studio-ide-181.5014246-linux; # Costumo fazer isso para ter o rastro da vers√£o do bin√°rio que eu instalei
    cd android-studio-ide-181.5014246-linux
    ./bin/studio.sh
    
Ao executar este √∫ltimo comando, o Android ir√° iniciar um wizard de instala√ß√£o.

Meus passos foram:

    - N√£o importar nada de configura√ß√µes e projetos outras vers√µes previamente instaladas.
    - Next
    - Custom
    - Theme: Darcula (minha prfer√™ncia)
    - Marquei os componentes Android SDK, Android SDK Platform, API 28 e Android Virtual Device e por fim coloquei o diret√≥rio customizado para instala√ß√£o do Android SDK em _**~/desenv/sdk/android**_.
    - Next 2x
    - Antes de finalizar ele informa que detectou que meu SO pode rodar o emulador em modo de performance acelerada e que meu linux tem suporte acelera√ß√£o de maquina virtual sobre o KVM, e que mais quest√µes sobre performance ou posso consultar a p√°gina do [link](https://developer.android.com/studio/run/emulator-acceleration?utm_source=android-studio#vm-linux).
    - Finish... wait... wait... wait... coffee.. wait... wait... coffee.. 

Ap√≥s a instala√ß√£o, fui testar meu ambiente Android criando uma aplica√ß√£o de exemplo.
Siga-me os bons... j√° dizia Chapolin Colorado

    - Start a new Android Studio project
    - Application Name: "My Application", Company domain: "foo.example.com", Project location: "~/desenv/projects/biblioteca-virtual/android/MyApplication" e Next
    - Check apenas "Phone and tablet" e selecione a API 23 (Android 6.0) - (Lembre-se que s√≥ estou validando a instala√ß√£o, n√£o tenho preten√ß√µes neste momento de fazer a aplica√ß√£o funcionar em v√°rios dispositivos) e Next
    - Template: Navigaion Drawer Activity e Next
    - Activity Name: "MainActivity", Layout Name: "activity_main", Title: "MainActivity" e Next e Finish

Ap√≥s a cria√ß√£o do projeto, e ao iniciar o Android Studio receber√° o seguinte erro:

    _**Failed to find Build Tools revision 27.0.3**_
    _**Install Build Tools 27.0.3 and sync project**_

Click sobre esse link de instala√ß√£o do Build Tools e siga os passo do wizard.

    - Aceite a licen√ßa, Next e Finish
    - Aguarde um pouco enquanto o Gradle baixa uns componentes do reposit√≥rio e o Android Studio fazer build do seu projeto.
    - Feche o arquivo content_main.xml e reabra logo em seguida. Ver√° que o Android Studio vai renderizar sua seu app inicial.

Agora vamos tentar executar nosso App.

    - Click em "Run App" (no canto superior direito)
    - O android pedir√° pra selecionar o dispositivo, no meu caso vou usar o emulador, pois n√£o tenho celular conectado no USB.
    - No meu caso j√° veio um Virtual Device chamado "Nexus 5X API 28 x86", selecione e click em Ok
    - E foi!!! O emulador iniciou e apresentou o App.

Opa!!! Menos um erro no flutter doctor -v

    ! Doctor found issues in 4 categories.

E para saber se voc√™ pode executar seu emulador com uma perfomance melhor, click sobre o icone "AVD Manager" no canto superior direito de seu Visual Studio e edite as configura√ß√µes do emulador que j√° veio instalado para usar o modo "Hardware - GLES 2.0" na op√ß√£o Emulated Performance Graphics.

Se seu emulardor iniciar normalmente, sucesso! Voc√™ j√° est√° com uma boa performance no seu emulador.. e deve estar iniciando bem r√°pido. Caso contr√°rio, ser√° necess√°rio configurar algumas coisas no seu SO para poder habilitar essa fun√ß√£o! Siga esses links para tentar identificar [link1](https://developer.android.com/studio/run/emulator-acceleration?utm_source=android-studio#vm-linux) e [link2](https://www.google.com.br/search?q=android+studio+emulator+performance&oq=emulate+android+performan&aqs=chrome.1.69i57j0l2.7512j0j7&sourceid=chrome&ie=UTF-8) .

#### 2 - Android Toolchain

Eu comecei pela instala√ß√£o do Android Studio porque eu j√° sabia que ia precisar instalar o Android SDK e que esse passo ia ser f√°cil de configurar em seguida.

Se observaram a mensagem de erro do flutter doctor, ele diz justamente que n√£o achou a vari√°rial de ambiente chamada ANDROID_HOME. Para configurar, segue:

E no final do arquivo ~/.bash_profile ou ~/.profile (vai depender de sua distro linux), coloque os trechos abaixo: (ap√≥s edi√ß√£o do arquivo refazer login no linux)

    ANDROID_HOME=~/desenv/sdk/android
    export ANDROID_HOME

Depois de fazer logout do Linux, rode o **flutter doctor -v** novamente.

Agora ele s√≥ pede pra rodar um comamndo pra aceitar as licen√ßas do android.

    [!] Android toolchain - develop for Android devices (Android SDK 28.0.2)
        ‚Ä¢ Android SDK at /home/hendi/desenv/sdk/android
        ‚Ä¢ Android NDK location not configured (optional; useful for native profiling support)
        ‚Ä¢ Platform android-28, build-tools 28.0.2
        ‚Ä¢ ANDROID_HOME = /home/hendi/desenv/sdk/android
        ‚Ä¢ Java binary at: /home/hendi/desenv/ide/android-studio/android-studio-ide-181.5014246-linux/jre/bin/java
        ‚Ä¢ Java version OpenJDK Runtime Environment (build 1.8.0_152-release-1024-b01)
        ! Some Android licenses not accepted.  To resolve this, run: flutter doctor --android-licenses

Execute no terminal ent√£o o comando solicitado e (y) pra tudo.

    flutter doctor --android-licenses


#### 3 - Flutter (Channel dev, v1.0.0, on Linux, locale pt_BR.UTF-8)

    ‚úó Downloaded executables cannot execute on host

Esse erro ocorre porque minha m√°quina √© 64bits e n√£o consigo gerar .apk para celulares 32bits (modo padr√£o de gerar apk pelo comando flluter build).

E no pr√≥prio log de erro e j√° informa que eu devo instalar uma lib no meu SO para dar compatibilidade com 32bits. E como meu SO √© o Fedora, vou executar o comando 'sudo dnf install libstdc++.i686' no terminal

    sudo dnf install libstdc++.i686
    
#### 4 - VS Code (version 1.26.1)

    Flutter extension not installed; install from

Esse warning ele s√≥ exibiu porque detectou que eu tenho o VSCode instalado na minha m√°quina. E para quem pretende usar o VSCode para desenvolver, ele pede pra instalar um plugin.

Basta rodar o comando abaixo no terminal.

    ‚ûú  ~ code --install-extension Dart-Code.flutter
    Found 'Dart-Code.flutter' in the marketplace.
    Installing...
    Extension 'Dart-Code.flutter' v2.17.1 was successfully installed!

#### 5 - Consultando o doctor

Olha que lindo!!! Zero erros!!!

    ‚ûú  ~ flutter doctor -v
    [‚úì] Flutter (Channel stable, v1.0.0, on Linux, locale en_US.UTF-8)
        ‚Ä¢ Flutter version 1.0.0 at /home/hendi/desenv/sdk/flutter/v1.0.0
        ‚Ä¢ Framework revision 5391447fae (13 days ago), 2018-11-29 19:41:26 -0800
        ‚Ä¢ Engine revision 7375a0f414
        ‚Ä¢ Dart version 2.1.0 (build 2.1.0-dev.9.4 f9ebf21297)

    [‚úì] Android toolchain - develop for Android devices (Android SDK 28.0.2)
        ‚Ä¢ Android SDK at /home/hendi/desenv/sdk/android
        ‚Ä¢ Android NDK location not configured (optional; useful for native profiling support)
        ‚Ä¢ Platform android-28, build-tools 28.0.2
        ‚Ä¢ ANDROID_HOME = /home/hendi/desenv/sdk/android
        ‚Ä¢ Java binary at: /home/hendi/desenv/ide/android-studio/android-studio-ide-181.5014246-linux/jre/bin/java
        ‚Ä¢ Java version OpenJDK Runtime Environment (build 1.8.0_152-release-1136-b06)
        ‚Ä¢ All Android licenses accepted.

    [‚úì] Android Studio (version 3.1)
        ‚Ä¢ Android Studio at /home/hendi/desenv/ide/android-studio/android-studio-ide-173.4907809-linux
        ‚Ä¢ Flutter plugin version 28.0.2
        ‚Ä¢ Dart plugin version 181.5616
        ‚Ä¢ Java version OpenJDK Runtime Environment (build 1.8.0_152-release-1136-b06)

    [‚úì] Android Studio (version 3.2)
        ‚Ä¢ Android Studio at /home/hendi/desenv/ide/android-studio/android-studio-ide-181.5014246-linux
        ‚Ä¢ Flutter plugin version 28.0.2
        ‚Ä¢ Dart plugin version 181.5616
        ‚Ä¢ Java version OpenJDK Runtime Environment (build 1.8.0_152-release-1136-b06)

    [‚úì] VS Code (version 1.29.1)
        ‚Ä¢ VS Code at /usr/share/code
        ‚Ä¢ Flutter extension version 2.21.1

    [‚úì] Connected device (1 available)
        ‚Ä¢ Android SDK built for x86 ‚Ä¢ emulator-5554 ‚Ä¢ android-x86 ‚Ä¢ Android 9 (API 28) (emulator)

    ‚Ä¢ No issues found!

**Observa√ß√µes:**: 

- Caso o √∫ltimo item mastrar a falha "[!] Connected device" √© porque voc√™ n√£o tem nenhum dispositivo conectado na m√°quiva ou n√£o tem nenhum emulador rodando durante a execu√ß√£o do comando.
- Se no seu ambiente voc√™ encontrou outros problemas, nos informe e mostre tamb√©m como √†s resolver... Ah! Ajude a criar uma se√ß√£o de intala√ßao em Mac e Windows (Deus me livre! :P).


# Criando uma App Flutter pra validar nossa instala√ß√£o - Usando o Android Studio

Voc√™ pode usar seu editor preferido pra criar a aplica√ß√£o... Provavelmente, daqui pra frente usarei o VisualCode, mas pra validar nossa instala√ß√£o vou fazer a aplica√ß√£o de teste usando o Android Studio.

## Instalando o plugin Flutter e Dart no Android Studio

    V√° no item de menu File > Settings > Plugins.
    Click em Browse repositories‚Ä¶, selecione o plugin Flutter e Flutter i18n e click em install.
    Tamb√©m procure o plugin Dart e instale-o.
    Depois reinicie o Android Studio.

## New project Flutter

Chagamos no ponto de criar nosso primeiro App Flutter!!!!

Acesse o menu File > New > New Flutter Project > Flutter Application e Next

    Project name: flutter_app
    Flutter SDK Path: ~/desenv/sdk/flutter/v1.0.0
    Project Location: ~/desenv/projetos/biblioteca-virtual
    Description: A new Flutter application.
    Next
    Company domain: example.com
    Finish
    Logo em seguida, pede para abrir o projeto na mesma janela ou em outra, selecionei mesma janela.
    Selecione o device emulado no canto superor direito do Android Studio e dois em Run App.
    Vair demorar um pouco a primeira vez, pois vai baixar umas depend√™ncias.

Pronto, nosso Hello World saiu!!!

## Criando nosso primeiro .apk android

Olha que simple, na pasta do projeo basta executar o comando 'flutter build apk'

    ‚ûú  flutter build apk                                
    Initializing gradle...                                       0,4s
    Resolving dependencies...                                    0,5s
    Running 'gradlew assembleRelease'...                         8,4s
    Built build/app/outputs/apk/release/app-release.apk (5.3MB).


## Criando nosso primeiro build IOS

Buaaaa... :(

    ‚ûú  flutter_app flutter build ios 
    Building for iOS is only supported on the Mac.


# Criando uma App Flutter pra validar nossa instala√ß√£o - Usando o Flutter Cli

Ola como √© simple criar um projeto novo com o Flutter Cli.

Execute no terminal.

## Criando o projeto

        cd /tmp
        flutter create -t app --description "Biblioteca Virtual" --org br.com.devapps.flutter -i swift -a kotlin biblioteca_virtual
        cd biblioteca_virtual

## Iniciando o emulador

        cd /tmp/biblioteca_virtual
        flutter emulators; # para ver os emuladores que voc√™ tem.
        flutter emulators --launch Nexus_5X_API_28_x86; # para iniciar o emulador

## Rodando seu app

        cd /tmp/biblioteca_virtual
        flutter run --build --hot

            output terminal...
            ‚ûú  biblioteca_virtual flutter run --build --hot 
            Using hardware rendering with device Android SDK built for x86. If you get graphics artifacts, consider enabling software rendering with "--enable-software-rendering".
            Launching lib/main.dart on Android SDK built for x86 in debug mode...
            Initializing gradle...                                       1,9s
            Resolving dependencies...                                    2,6s
            Running 'gradlew assembleDebug'...                          14,2s
            Built build/app/outputs/apk/debug/app-debug.apk.
            Installing build/app/outputs/apk/app.apk...                  0,8s
            Syncing files to device Android SDK built for x86...             
            I/Choreographer( 9394): Skipped 33 frames!  The application may be doing too much work on its main thread.
            D/EGL_emulation( 9394): eglMakeCurrent: 0xebfdca00: ver 2 0 (tinfo 0xd3ac1310)
            D/        ( 9394): HostConnection::get() New Host Connection established 0xceeb8180, tid 9427
            D/EGL_emulation( 9394): eglMakeCurrent: 0xebfdcb20: ver 2 0 (tinfo 0xd3ac1000)
            3,6s

            üî•  To hot reload changes while running, press "r". To hot restart (and rebuild state), press "R".
            An Observatory debugger and profiler on Android SDK built for x86 is available at: http://127.0.0.1:36485/
            For a more detailed help message, press "h". To quit, press "q".

--------------------------------------------------

Se n√£o funcionou pra voc√™, conte-nos para que possamos te ajudar.

E sinta-se a vontade para corrigir quaisquer passo deste guia!


